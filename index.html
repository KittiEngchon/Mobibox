<!DOCTYPE html>
<html lang="en" class="bg-black text-white">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mobibox App Store</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          animation: {
            fadeIn: 'fadeIn 0.5s ease-in-out',
          },
          keyframes: {
            fadeIn: {
              '0%': { opacity: 0 },
              '100%': { opacity: 1 }
            }
          }
        }
      }
    }
  </script>
</head>
<body class="min-h-screen px-4 py-6">
  <header class="flex justify-between items-center mb-6">
    <div>
      <h1 class="text-3xl font-bold">üöÄ Mobibox App Store</h1>
      <p class="text-gray-400">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏≠‡∏õ‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ ‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏õ‡∏¥‡∏î</p>
    </div>
    <div class="space-x-2">
      <button onclick="connectWallet()" class="bg-indigo-500 px-4 py-1 rounded">Connect Wallet</button>
      <button onclick="switchChain()" class="bg-teal-600 px-4 py-1 rounded">Switch to Polygon</button>
    </div>
  </header>

  <div class="mb-4 flex flex-wrap gap-2">
    <label class="mr-2">Open Mode:</label>
    <select id="openMode" class="text-black rounded px-2 py-1 mr-4">
      <option value="full">Full Page</option>
      <option value="iframe">iFrame</option>
      <option value="modal">Popup Modal</option>
    </select>

    <button onclick="filterCategory('all')" class="bg-gray-700 px-3 py-1 rounded">All</button>
    <button onclick="filterCategory('Finance')" class="bg-purple-700 px-3 py-1 rounded">Finance</button>
    <button onclick="filterCategory('NFT')" class="bg-pink-700 px-3 py-1 rounded">NFT</button>
    <button onclick="filterCategory('Social')" class="bg-green-700 px-3 py-1 rounded">Social</button>
    <button onclick="filterCategory('Gaming')" class="bg-indigo-700 px-3 py-1 rounded">Gaming</button>
    <button onclick="filterCategory('GameFi')" class="bg-blue-800 px-3 py-1 rounded">GameFi</button>
    <button onclick="filterCategory('Tools')" class="bg-gray-800 px-3 py-1 rounded">Tools</button>
  </div>

  <main id="appList" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"></main>

  <div id="modal" class="fixed inset-0 bg-black bg-opacity-80 hidden items-center justify-center z-50">
    <div class="relative w-full h-full max-w-4xl max-h-[90vh]">
      <button onclick="closeModal()" class="absolute top-2 right-2 bg-red-600 px-2 py-1 rounded">Close</button>
      <iframe id="modalFrame" src="" class="w-full h-full rounded-xl"></iframe>
    </div>
  </div>

  <script>
    let apps = [];

    async function loadApps(category = 'all') {
      const res = await fetch('./apps.json');
      apps = await res.json();
      renderApps(category);
    }

    function renderApps(category = 'all') {
      const appList = document.getElementById('appList');
      appList.innerHTML = '';
      apps.filter(app => category === 'all' || app.category === category).forEach(app => {
        const div = document.createElement('div');
        div.className = `${app.color} rounded-xl p-4 shadow-lg transition transform hover:scale-105 animate-fadeIn`;
        div.innerHTML = `
          <h2 class="text-xl font-bold mb-1">${app.name}</h2>
          <p class="text-sm text-gray-100">${app.desc}</p>
          <button onclick="openApp('${app.url}')" class="mt-3 bg-black px-3 py-1 rounded">Open</button>
        `;
        appList.appendChild(div);
      });
    }

    function filterCategory(category) {
      renderApps(category);
    }

    function openApp(url) {
      const mode = document.getElementById('openMode').value;
      if (mode === 'full') {
        window.open(url, '_blank');
      } else if (mode === 'iframe') {
        const win = window.open('', '_blank');
        win.document.write(`<iframe src='${url}' style='width:100%;height:100vh;border:none;'></iframe>`);
      } else if (mode === 'modal') {
        document.getElementById('modalFrame').src = url;
        document.getElementById('modal').classList.remove('hidden');
        document.getElementById('modal').classList.add('flex');
      }
    }

    function closeModal() {
      document.getElementById('modal').classList.add('hidden');
      document.getElementById('modal').classList.remove('flex');
      document.getElementById('modalFrame').src = '';
    }

    async function connectWallet() {
      if (typeof window.ethereum !== 'undefined') {
        try {
          const accounts = await ethereum.request({ method: 'eth_requestAccounts' });
          alert('Connected: ' + accounts[0]);
        } catch (err) {
          alert('Connection failed');
        }
      } else {
        alert('No wallet found');
      }
    }

    async function switchChain() {
      try {
        await window.ethereum.request({
          method: 'wallet_addEthereumChain',
          params: [{
            chainId: '0x89',
            chainName: 'Polygon Mainnet',
            nativeCurrency: {
              name: 'MATIC',
              symbol: 'MATIC',
              decimals: 18
            },
            rpcUrls: ['https://polygon-rpc.com/'],
            blockExplorerUrls: ['https://polygonscan.com/']
          }]
        });
      } catch (error) {
        alert('Chain switch failed');
      }
    }

    window.onload = () => loadApps();
  </script>
</body>
</html>

